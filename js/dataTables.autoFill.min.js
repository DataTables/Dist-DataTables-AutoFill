/*!
   Copyright 2010-2021 SpryMedia Ltd.

 This source file is free software, available under the following license:
   MIT license - http://datatables.net/license/mit

 This source file is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.

 For details please refer to: http://www.datatables.net
 AutoFill 2.3.7
 Â©2008-2021 SpryMedia Ltd - datatables.net/license
*/
(function(f){"function"===typeof define&&define.amd?define(["jquery","datatables.net"],function(r){return f(r,window,document)}):"object"===typeof exports?module.exports=function(r,k){r||(r=window);k&&k.fn.dataTable||(k=require("datatables.net")(r,k).$);return f(k,r,r.document)}:f(jQuery,window,document)})(function(f,r,k,A){var w=f.fn.dataTable,B=0,p=function(a,c){if(!w.versionCheck||!w.versionCheck("1.10.8"))throw"Warning: AutoFill requires DataTables 1.10.8 or greater";this.c=f.extend(!0,{},w.defaults.autoFill,
p.defaults,c);this.s={dt:new w.Api(a),namespace:".autoFill"+B++,scroll:{},scrollInterval:null,handle:{height:0,width:0},enabled:!1};this.dom={handle:f('<div class="dt-autofill-handle"/>'),select:{top:f('<div class="dt-autofill-select top"/>'),right:f('<div class="dt-autofill-select right"/>'),bottom:f('<div class="dt-autofill-select bottom"/>'),left:f('<div class="dt-autofill-select left"/>')},background:f('<div class="dt-autofill-background"/>'),list:f('<div class="dt-autofill-list">'+this.s.dt.i18n("autoFill.info",
"")+"<ul/></div>"),dtScroll:null,offsetParent:null};this._constructor()};f.extend(p.prototype,{enabled:function(){return this.s.enabled},enable:function(a){var c=this;if(!1===a)return this.disable();this.s.enabled=!0;this._focusListener();this.dom.handle.on("mousedown",function(b){c._mousedown(b);return!1});return this},disable:function(){this.s.enabled=!1;this._focusListenerRemove();return this},_constructor:function(){var a=this,c=this.s.dt,b=f("div.dataTables_scrollBody",this.s.dt.table().container());
c.settings()[0].autoFill=this;b.length&&(this.dom.dtScroll=b,"static"===b.css("position")&&b.css("position","relative"));!1!==this.c.enable&&this.enable();c.on("destroy.autoFill",function(){a._focusListenerRemove()})},_attach:function(a){var c=this.s.dt,b=c.cell(a).index(),d=this.dom.handle,e=this.s.handle;b&&-1!==c.columns(this.c.columns).indexes().indexOf(b.column)?(this.dom.offsetParent||(this.dom.offsetParent=f(c.table().node()).offsetParent()),e.height&&e.width||(d.appendTo("body"),e.height=
d.outerHeight(),e.width=d.outerWidth()),c=this._getPosition(a,this.dom.offsetParent),this.dom.attachedTo=a,d.css({top:c.top+a.offsetHeight-e.height,left:c.left+a.offsetWidth-e.width}).appendTo(this.dom.offsetParent)):this._detach()},_actionSelector:function(a){var c=this,b=this.s.dt,d=p.actions,e=[];f.each(d,function(l,m){m.available(b,a)&&e.push(l)});if(1===e.length&&!1===this.c.alwaysAsk){var g=d[e[0]].execute(b,a);this._update(g,a)}else if(1<e.length){var h=this.dom.list.children("ul").empty();
e.push("cancel");f.each(e,function(l,m){h.append(f("<li/>").append('<div class="dt-autofill-question">'+d[m].option(b,a)+"<div>").append(f('<div class="dt-autofill-button">').append(f('<button class="'+p.classes.btn+'">'+b.i18n("autoFill.button","&gt;")+"</button>").on("click",function(){var t=d[m].execute(b,a,f(this).closest("li"));c._update(t,a);c.dom.background.remove();c.dom.list.remove()}))))});this.dom.background.appendTo("body");this.dom.list.appendTo("body");this.dom.list.css("margin-top",
this.dom.list.outerHeight()/2*-1)}},_detach:function(){this.dom.attachedTo=null;this.dom.handle.detach()},_drawSelection:function(a,c){var b=this.s.dt;c=this.s.start;var d=f(this.dom.start),e={row:this.c.vertical?b.rows({page:"current"}).nodes().indexOf(a.parentNode):c.row,column:this.c.horizontal?f(a).index():c.column};a=b.column.index("toData",e.column);var g=b.row(":eq("+e.row+")",{page:"current"});g=f(b.cell(g.index(),a).node());if(b.cell(g).any()&&-1!==b.columns(this.c.columns).indexes().indexOf(a)){this.s.end=
e;b=c.row<e.row?d:g;var h=c.row<e.row?g:d;a=c.column<e.column?d:g;d=c.column<e.column?g:d;b=this._getPosition(b.get(0)).top;a=this._getPosition(a.get(0)).left;c=this._getPosition(h.get(0)).top+h.outerHeight()-b;d=this._getPosition(d.get(0)).left+d.outerWidth()-a;e=this.dom.select;e.top.css({top:b,left:a,width:d});e.left.css({top:b,left:a,height:c});e.bottom.css({top:b+c,left:a,width:d});e.right.css({top:b,left:a+d,height:c})}},_editor:function(a){var c=this.s.dt,b=this.c.editor;if(b){for(var d={},
e=[],g=b.fields(),h=0,l=a.length;h<l;h++)for(var m=0,t=a[h].length;m<t;m++){var q=a[h][m],u=c.settings()[0].aoColumns[q.index.column],n=u.editField;if(n===A){u=u.mData;for(var v=0,x=g.length;v<x;v++){var y=b.field(g[v]);if(y.dataSrc()===u){n=y.name();break}}}if(!n)throw"Could not automatically determine field data. Please see https://datatables.net/tn/11";d[n]||(d[n]={});u=c.row(q.index.row).id();d[n][u]=q.set;e.push(q.index)}b.bubble(e,!1).multiSet(d).submit()}},_emitEvent:function(a,c){this.s.dt.iterator("table",
function(b,d){f(b.nTable).triggerHandler(a+".dt",c)})},_focusListener:function(){var a=this,c=this.s.dt,b=this.s.namespace,d=null!==this.c.focus?this.c.focus:c.init().keys||c.settings()[0].keytable?"focus":"hover";if("focus"===d)c.on("key-focus.autoFill",function(e,g,h){a._attach(h.node())}).on("key-blur.autoFill",function(e,g,h){a._detach()});else if("click"===d)f(c.table().body()).on("click"+b,"td, th",function(e){a._attach(this)}),f(k.body).on("click"+b,function(e){f(e.target).parents().filter(c.table().body()).length||
a._detach()});else f(c.table().body()).on("mouseenter"+b,"td, th",function(e){a._attach(this)}).on("mouseleave"+b,function(e){f(e.relatedTarget).hasClass("dt-autofill-handle")||a._detach()})},_focusListenerRemove:function(){var a=this.s.dt;a.off(".autoFill");f(a.table().body()).off(this.s.namespace);f(k.body).off(this.s.namespace)},_getPosition:function(a,c){var b=0,d=0;c||(c=f(f(this.s.dt.table().node())[0].offsetParent));do{var e=a.offsetTop,g=a.offsetLeft;var h=f(a.offsetParent);b+=e+1*parseInt(h.css("border-top-width")||
0);d+=g+1*parseInt(h.css("border-left-width")||0);if("body"===a.nodeName.toLowerCase())break;a=h.get(0)}while(h.get(0)!==c.get(0));return{top:b,left:d}},_mousedown:function(a){var c=this,b=this.s.dt;this.dom.start=this.dom.attachedTo;this.s.start={row:b.rows({page:"current"}).nodes().indexOf(f(this.dom.start).parent()[0]),column:f(this.dom.start).index()};f(k.body).on("mousemove.autoFill",function(e){c._mousemove(e)}).on("mouseup.autoFill",function(e){c._mouseup(e)});var d=this.dom.select;b=f(b.table().node()).offsetParent();
d.top.appendTo(b);d.left.appendTo(b);d.right.appendTo(b);d.bottom.appendTo(b);this._drawSelection(this.dom.start,a);this.dom.handle.css("display","none");a=this.dom.dtScroll;this.s.scroll={windowHeight:f(r).height(),windowWidth:f(r).width(),dtTop:a?a.offset().top:null,dtLeft:a?a.offset().left:null,dtHeight:a?a.outerHeight():null,dtWidth:a?a.outerWidth():null}},_mousemove:function(a){var c=a.target.nodeName.toLowerCase();if("td"===c||"th"===c)this._drawSelection(a.target,a),this._shiftScroll(a)},_mouseup:function(a){f(k.body).off(".autoFill");
var c=this,b=this.s.dt,d=this.dom.select;d.top.remove();d.left.remove();d.right.remove();d.bottom.remove();this.dom.handle.css("display","block");d=this.s.start;var e=this.s.end;if(d.row!==e.row||d.column!==e.column){var g=b.cell(":eq("+d.row+")",d.column+":visible",{page:"current"});if(f("div.DTE",g.node()).length){var h=b.editor();h.on("submitSuccess.dtaf close.dtaf",function(){h.off(".dtaf");setTimeout(function(){c._mouseup(a)},100)}).on("submitComplete.dtaf preSubmitCancelled.dtaf close.dtaf",
function(){h.off(".dtaf")});h.submit()}else{var l=this._range(d.row,e.row);d=this._range(d.column,e.column);e=[];for(var m=b.settings()[0],t=m.aoColumns,q=b.columns(this.c.columns).indexes(),u=0;u<l.length;u++)e.push(f.map(d,function(n){var v=b.row(":eq("+l[u]+")",{page:"current"});n=b.cell(v.index(),n+":visible");v=n.data();var x=n.index(),y=t[x.column].editField;y!==A&&(v=m.oApi._fnGetObjectDataFn(y)(b.row(x.row).data()));if(-1!==q.indexOf(x.column))return{cell:n,data:v,label:n.data(),index:x}}));
this._actionSelector(e);clearInterval(this.s.scrollInterval);this.s.scrollInterval=null}}},_range:function(a,c){var b=[];if(a<=c)for(;a<=c;a++)b.push(a);else for(;a>=c;a--)b.push(a);return b},_shiftScroll:function(a){var c=this,b=this.s.scroll,d=!1,e=a.pageY-k.body.scrollTop,g=a.pageX-k.body.scrollLeft,h,l,m,t;65>e?h=-5:e>b.windowHeight-65&&(h=5);65>g?l=-5:g>b.windowWidth-65&&(l=5);null!==b.dtTop&&a.pageY<b.dtTop+65?m=-5:null!==b.dtTop&&a.pageY>b.dtTop+b.dtHeight-65&&(m=5);null!==b.dtLeft&&a.pageX<
b.dtLeft+65?t=-5:null!==b.dtLeft&&a.pageX>b.dtLeft+b.dtWidth-65&&(t=5);h||l||m||t?(b.windowVert=h,b.windowHoriz=l,b.dtVert=m,b.dtHoriz=t,d=!0):this.s.scrollInterval&&(clearInterval(this.s.scrollInterval),this.s.scrollInterval=null);!this.s.scrollInterval&&d&&(this.s.scrollInterval=setInterval(function(){b.windowVert&&(k.body.scrollTop+=b.windowVert);b.windowHoriz&&(k.body.scrollLeft+=b.windowHoriz);if(b.dtVert||b.dtHoriz){var q=c.dom.dtScroll[0];b.dtVert&&(q.scrollTop+=b.dtVert);b.dtHoriz&&(q.scrollLeft+=
b.dtHoriz)}},20))},_update:function(a,c){if(!1!==a){a=this.s.dt;var b=a.columns(this.c.columns).indexes();this._emitEvent("preAutoFill",[a,c]);this._editor(c);if(null!==this.c.update?this.c.update:!this.c.editor){for(var d=0,e=c.length;d<e;d++)for(var g=0,h=c[d].length;g<h;g++){var l=c[d][g];-1!==b.indexOf(l.index.column)&&l.cell.data(l.set)}a.draw(!1)}this._emitEvent("autoFill",[a,c])}}});p.actions={increment:{available:function(a,c){a=c[0][0].label;return!isNaN(a-parseFloat(a))},option:function(a,
c){return a.i18n("autoFill.increment",'Increment / decrement each cell by: <input type="number" value="1">')},execute:function(a,c,b){a=1*c[0][0].data;b=1*f("input",b).val();for(var d=0,e=c.length;d<e;d++)for(var g=0,h=c[d].length;g<h;g++)c[d][g].set=a,a+=b}},fill:{available:function(a,c){return!0},option:function(a,c){return a.i18n("autoFill.fill","Fill all cells with <i>%d</i>",c[0][0].label)},execute:function(a,c,b){a=c[0][0].data;b=0;for(var d=c.length;b<d;b++)for(var e=0,g=c[b].length;e<g;e++)c[b][e].set=
a}},fillHorizontal:{available:function(a,c){return 1<c.length&&1<c[0].length},option:function(a,c){return a.i18n("autoFill.fillHorizontal","Fill cells horizontally")},execute:function(a,c,b){a=0;for(b=c.length;a<b;a++)for(var d=0,e=c[a].length;d<e;d++)c[a][d].set=c[a][0].data}},fillVertical:{available:function(a,c){return 1<c.length},option:function(a,c){return a.i18n("autoFill.fillVertical","Fill cells vertically")},execute:function(a,c,b){a=0;for(b=c.length;a<b;a++)for(var d=0,e=c[a].length;d<e;d++)c[a][d].set=
c[0][d].data}},cancel:{available:function(){return!1},option:function(a){return a.i18n("autoFill.cancel","Cancel")},execute:function(){return!1}}};p.version="2.3.6";p.defaults={alwaysAsk:!1,focus:null,columns:"",enable:!0,update:null,editor:null,vertical:!0,horizontal:!0};p.classes={btn:"btn"};var z=f.fn.dataTable.Api;z.register("autoFill()",function(){return this});z.register("autoFill().enabled()",function(){var a=this.context[0];return a.autoFill?a.autoFill.enabled():!1});z.register("autoFill().enable()",
function(a){return this.iterator("table",function(c){c.autoFill&&c.autoFill.enable(a)})});z.register("autoFill().disable()",function(){return this.iterator("table",function(a){a.autoFill&&a.autoFill.disable()})});f(k).on("preInit.dt.autofill",function(a,c,b){"dt"===a.namespace&&(a=c.oInit.autoFill,b=w.defaults.autoFill,a||b)&&(b=f.extend({},a,b),!1!==a&&new p(c,b))});w.AutoFill=p;return w.AutoFill=p});
